1.PIR with sqlite & mqtt
-------------------------
import RPi.GPIO as GPIO
import sqlite3
import datetime
import time
import paho.mqtt.client as mqtt

broker_url = "broker.emqx.io"
broker_port = 1883
client = mqtt.Client()
client.connect(broker_url,broker_port)

GPIO.setmode(GPIO.BCM)
GPIO.setup(24,GPIO.OUT)
GPIO.setup(18,GPIO.IN)

connection = sqlite3.connect("PirSensor-SQL.db")

crsr = connection.cursor()

sql_createtbl = """create table if not exists DATA(
    status TEXT,
    time DATE);"""
crsr.execute(sql_createtbl)

while(True):
    mypin = GPIO.input(18)
    if mypin == True:
        print("detected")
        time.sleep(1)
        GPIO.output(24,True)
        crsr.execute("INSERT INTO DATA(status,time) VALUES(?,?)",("Object detected",datetime.datetime.now()))
        crsr.execute("select * from DATA")
        ans = crsr.fetchall()

        print(ans)
 
        client.publish("MS", qos=0,payload="Object detected - "+str(datetime.datetime.now()),retain=False)
        
        time.sleep(0.05)
        GPIO.output(24,False)
        print("Not detected")
        time.sleep(0.3)
