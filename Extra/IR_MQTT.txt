2.IR with sqlite & mqtt
-------------------------
import RPi.GPIO as IO
import sqlite3
import datetime
import time
import paho.mqtt.client as mqtt
broker_url = "broker.emqx.io"
broker_port = 1883
client = mqtt.Client()
client.connect(broker_url,broker_port)

IO.setwarnings(False)
IO.setmode(IO.BOARD)
IO.setup(8, IO.IN)
IO.setup(3, IO.OUT)

connection = sqlite3.connect("IR-SQL.db")

crsr = connection.cursor()

sql_createtbl = """create table if not exists DATA(
    status TEXT,
    time DATE);"""
crsr.execute(sql_createtbl)

while 1:
           if(IO.input(8) == True):
               print("Obstacle detected !!")
               IO.output(3, True)
               crsr.execute("INSERT INTO DATA(status,time) VALUES(?,?)",("Object detected",datetime.datetime.now()))
               crsr.execute("select * from DATA")
               ans = crsr.fetchall()

               print(ans)
 
               client.publish("MS", qos=0,payload="Object detected - "+str(datetime.datetime.now()),retain=False)
               time.sleep(0.2)
           else:
               print("Obstacle not detected !!")
               IO.output(3, False)
               time.sleep(0.2)
